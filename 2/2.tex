% !TeX program	= xelatex
% !TeX encoding	= UTF-8

%-------------------- 文类 --------------------
\documentclass[UTF8, a4paper, 12pt, oneside, onecolumn]{article}

%-------------------- 宏包 --------------------
\input{../../template/usepackage}

%-------------------- 杂项 --------------------
\input{../../template/misc}
\def\homeworkName{抛物型偏微分方程的差分方法}
\hypersetup
{
	% 颜色
	colorlinks	= true,
	linkcolor	= black,
	urlcolor	= red,
	citecolor	= black,
	anchorcolor	= blue,
}

%-------------------- 字体设置 --------------------
\input{../../template/fonts}

%-------------------- 标题样式 --------------------
\input{../title}

%-------------------- 自定义符号 --------------------
\input{../../template/symbols}

%-------------------- 自定义环境 --------------------
\input{../../template/environments}

%-------------------- \item 编号 --------------------
\input{../../template/itemstyle}

%-------------------- 代码样式设置 --------------------
\input{../../template/codestyle}

%-------------------- PDF 元信息, 建模时注释掉 --------------------
\input{../pdfinfo}

%-------------------- 页眉页脚 --------------------
\input{../headersfooters}
\usepackage[ntheorem]{empheq}

%-------------------- 正文 --------------------
\begin{document}

\thispagestyle{plain}

%\columnseprule = 1pt	% 栏线
\begin{center}
	{\zihao{-2}\heiti \homeworkName} \\
	\vspace{1.5ex}
	{\zihao{-4}\fangsong 阙嘉豪\textsuperscript{\hyperref[auth:1]{1}}} \\
	{\zihao{6}\songti \label{auth:1}(1. 北京师范大学 数学科学学院, 北京~~100875)}
\end{center}

\zihao{5}

%\watermark{60}{10}{\currenttime}

\section{模型问题}

考虑 $\Omega := (0, 1)$ 上的热传导方程的 Dirichlet 初边值问题:
\begin{subequations}\label{equ:DirichletProblem}
	\begin{empheq}[left = {\empheqlbrace}]{align}
		u_t &= u_{xx},	&	0 < x < 1,&~t > 0,		\label{equ:DirichletProblem1}\\
		u(x, 0) &= u^0(x),	&	0 \leq x \leq 1,&	\nonumber\\
		u(0, t) &= u(1, t) = 0,	&	&~t > 0.		\label{equ:DirichletProblem3}
	\end{empheq}
\end{subequations}
由分离变量法可以证明, 方程 \eqref{equ:DirichletProblem1} 在齐次 Dirichelet 边界条件 \eqref{equ:DirichletProblem3} 下的一族相互独立的非平凡特解为
$$u_k(x, t) = \e^{-k^2\pi^2 t} \sin k\pi x,\quad k = 1, 2, \cdots.$$
若初值 $u_0$ 可以展开成 Fourier 正弦级数, 即
\begin{equation*}
	u^0\(x\) = \dsum_{k=1}^{\infty}a_k\sin k\pi x,  
\end{equation*}
其中
\begin{equation*}
	a_k = 2\int_0^1 u^0\(x\) \sin k\pi xdx, \quad k=1,2, \cdots,
\end{equation*}
则模型问题 \eqref{equ:DirichletProblem} 的解可以表示为
\begin{equation}\label{2.2.7}
	u\(x, t\) = \dsum_{k=1}^{\infty}a_k \mathrm{e}^{-k^2\pi^2 t}\sin k\pi x. 
\end{equation}

\subsection{差分逼近}

下面考虑模型问题 \eqref{equ:DirichletProblem} 的差分逼近. 首先, 在$[0,1]\times \mathbb{R}_+$ 上引入网格. 为简单起见, 我们只限于考虑均匀网格. 任给正整数$N$, 令空间步长
$$h=h_N = \Delta x=\frac{1}{N},\quad x_j = jh,\quad j=0,1,\cdots, N,$$
再令时间步长
$$\tau = \Delta t,\quad t_m = m\tau,\quad m=0,1,\cdots,$$
则平行于$t$轴的直线族$x = x_j$, $j=0,1, \cdots, N$ 和平行于$x$轴的直线族$t =t_m$, $m=0,1, \cdots$给出了$[0,1]\times \mathbb{R}_+$上的一个均匀网格, 其网格节点集为$\{(x_j, t_m)\}$. 在不会引起混淆时, 为简化记号, 常将节点$\(x_j, t_m\)$简记为$\(j,m\)$. 其次, 在网格上定义网格函数
\begin{equation*}
	U := U_{\(h, \tau\)} := \lrb{U_j^m :\quad j=0,1, \cdots, N,\quad m=0,1, \cdots}, 
\end{equation*}
模型问题 \eqref{equ:DirichletProblem} 的真解$u$在网格节点$\(x_j, t_m\)$上的取值记为$u_j^m$, 即
\begin{equation*}
	u_j^m = u\(x_j, t_m\). 
\end{equation*}
我们需要用适当的差分算子替换原问题中的微分算子, 从而导出关于网格函数$U$的差分方程初边值问题是适定的, 即其解$U$存在唯一且稳定, 并且$U$在一定的意义下逼近真解$u$. 

以下我们用三种格式: 显式格式, 隐式格式和 Crank-Nicolson 格式求解模型问题, 并分析它们的稳定性, 收敛性和误差.

\subsection{显式格式}

% \begin{figure}[H]
% 	\centering\zihao{-5}
% 	\begin{tikzpicture}[scale=1.0,bullet/.style={circle,fill=#1,inner sep=1.5pt}] 
% 		\draw[step=0.5cm] (0,0) grid (9,4.25) foreach \X in {4,4.5,5} {foreach \Y in {2}
% 			{
% 				(\X,\Y) node[bullet=black]{}
% 		}}
% 	(4.5,2.5) node[bullet=black]{}
% 	(4,-0.1) node[below]{\tiny$j-1$}
% 	(4.5,-0.1) node[below]{\tiny$j$}
% 	(5,-0.1) node[below]{\tiny$j+1$}
% 	(-0.1,2) node[left]{\tiny$m$}
% 	(-0.1,2.5) node[left]{\tiny$m+1$}
% 	(-0.3,-0) node[below]{$O$};
% 		\draw[->]	(0,-0.5) -- (0,4.5) node[above]{$t$};
% 		\draw[->] (-0.5,0) -- (9.5,0) node[right]{$x$};
% 	\end{tikzpicture}
% 	\caption{显式格式均匀网格示意图}
% 	\label{1}
% \end{figure}

% 对定义在如图 \ref{1} 所示的均匀网格上的网格函数, 
在时间方向用一阶向前差商$\frac{\Delta_{+t}}{\Delta t}$替换时间一阶微商$\frac{\partial }{\partial t}$, 在空间方向用二阶中心差商$\frac{\delta_x^2}{\(\Delta x\)^2}$替换空间二阶微商$\frac{\partial^2}{\partial x^2}$, 就得到了模型问题 \eqref{equ:DirichletProblem} 的最简单的差分格式:
\begin{subequations}\label{2.2}
	\begin{empheq}[left = {\empheqlbrace}]{align}
		\frac{U_{j}^{m+1}-U_j^m}{\tau } &= \frac{U_{j+1}^m-2U_j^m+U_{j-1}^m}{h^2}, & 1&\leq j\leq N-1,& m&\geq 0,\label{2.2.8}\\
		U_j^0 &=u_j^0, &0&\leq j\leq N,&\nonumber\\
		U_0^m &=U_N^m=0, &&&m&\geq 1.\nonumber
	\end{empheq}
\end{subequations}
由 \eqref{2.2.8} 式可得
\begin{equation}\label{2.1}
	U_j^{m+1} = \mu U_{j+1}^m +\(1-2\mu\)U_j^m +\mu U_{j-1}^m, \quad \mu=\frac{\tau}{h^2}. 
\end{equation}
如果已知第$m$个时间层$t_m$上的网格函数值$U^m = \{U_j^m\}_{j=0}^N$, 则由 \eqref{2.1} 式即可相互独立地直接计算出$U_j^{m+1}$, $j=1, \cdots, N-1$. 我们把这样的差分格式称为两时间层向前差分显式差分格式, 简称显式格式.

\subsubsection{显式格式的截断误差}

引入截断误差算子
\begin{equation}\label{2.2.11}
	T_{\(h, \tau\)} = \(\frac{\Delta_{+t}}{\tau} - \frac{\delta_x^2}{h^2}\) - \(\frac{\partial }{\partial t} - \frac{\partial^2}{\partial x^2}\).
\end{equation}
以下为记号简单起见, 我们经常会省略掉$T_{\(h, \tau\)}$及其他一些符号的下标$\(h, \tau\)$. 

设$u$是定义在$\(0, 1\)\times \mathbb{R}_+$上的充分光滑的函数, 由$u$在点$\(x, t\)$的Taylor展开式易得
\begin{align*}
	\Delta_{+t} u\(x, t\) & :=  u\(x, t+\Delta t\) - u\(x, t\) \\
	&~= u_t\(x, t\)\Delta t+\frac{1}{2}u_{tt}\(x, t\)\(\Delta t\)^2+\frac{1}{6}u_{ttt}\(x, t\)(\Delta t^3)+\cdots, \\
	\delta_x^2 u(x, t) & :=  u\(x+\Delta x, t\) - 2u\(x, t\)+u\(x-\Delta x, t\) \\
	&~= u_{xx}\(x, t\)\(\Delta x\)^2+\frac{1}{12}u_{xxxx}\(x, t\)\(\Delta x\)^4+\cdots, 
\end{align*}
则有
\begin{equation*}
	T u\(x, t\) = \frac{1}{2}u_{tt}\(x, t\)\tau-\frac{1}{12}u_{xxxx}\(x, t\)h^2+O\(\tau^2+h^4\). 
\end{equation*}
由此可知
\begin{equation*}
	\lim\limits_{h \to 0, \tau \to 0}T_{\(h, \tau\) } = 0, 
\end{equation*}
即差分格式是相容的. 由余项形式的Taylor展开
\begin{align*}
	\Delta_{+t} u\(x, t\) &= u_t\(x, t\)\Delta t+\frac{1}{2}u_{tt}\(x, \eta\)\(\Delta t\)^2, \\
	\delta_x^2 u(x, t) &= u_{xx}\(x, t\)\(\Delta x\)^2+\frac{1}{12}u_{xxxx}\(\xi, t\)\(\Delta x\)^4, 
\end{align*}
其中$\eta\in \(t, t+\tau\)$, $\xi\in \(x-h, x+h\)$, 可将截断误差表示为
\begin{equation*}
	Tu\(x, t\) = \frac{1}{2}u_{tt}\(x, \eta\)\tau -\frac{1}{12}u_{xxxx}\(\xi, t\)h^2,
\end{equation*}
即
\begin{equation*}
	Tu\(x, t\)=O\(\tau\)+O\(h^2\).
\end{equation*}
我们称显式格式 \eqref{2.2.8} 的截断误差关于时间和空间分别具有一阶和二阶精度. 

进一步, 记$\Omega_{t_{\max}} = \(0,1\)\times \(0, t_{\max}\)$, 其中 $t_{\max}$是取定的一个时刻. 当
$$M_{tt}  :=  \max\limits_{\(x, t\)\in \bar{\Omega}_{t_{\max}}}\left| u_{tt}\(x, t\)\right|,\quad M_{xxxx}  :=  \max\limits_{\(x, t\)\in \bar{\Omega}_{t_{\max}}}\left| u_{xxxx}\(x, t\)\right|$$
为有界量时, 我们有
\begin{equation}\label{2.2.19}
	\left| Tu\(x, t\)\right| \leq \frac{1}{2}M_{tt}\tau+\frac{1}{12}M_{xxxx}h^2, \quad \forall \(x, t\)\in \Omega_{t_{\max}}. 
\end{equation}

\subsubsection{显式格式的稳定性, 收敛性分析}

\begin{Conclusion}
	显式格式精度为$O\(\tau+h^2\)$, 且 $0<\mu\leq \frac{1}{2}$时, 显式格式在$\mathbb{L}^{\infty}$意义下具有稳定性和收敛性, 收敛速度为$O\(\tau\)$. 
\end{Conclusion}

\begin{Proof}
% 由 \eqref{2.1} 式可知
% \begin{align*}
% 	L_{\(h, \tau\)} U_{j}^{m+1} :=  \(\frac{\delta_x^2}{\Delta x^2}-\frac{\Delta_{+t}}{\Delta t}\) U_j^m = 0. 
% \end{align*}
% 又对于模型问题的解$u$有
% \begin{align*}
% 	L_{\(h, \tau\)} u_{j}^{m+1}+Tu_j^{m+1} = 0. 
% \end{align*}
定义逼近误差$e=U-u$的网格函数
\begin{equation*}
	e_j^m := U_j^m -u\(x_j, t_m\), \quad j=0,1, \cdots, N,\quad m=0,1, \cdots,
\end{equation*}
则由方程 \eqref{equ:DirichletProblem1}, \eqref{2.2.8} 和截断误差算子的定义 \eqref{2.2.11} 知, 逼近误差$e$是以下差分方程初边值问题的解:
\begin{subequations}
	\begin{empheq}[left = {\empheqlbrace}]{align}
		\frac{e_{j}^{m+1}-e_j^m}{\tau } &= \frac{e_{j+1}^m-2e_j^m+e_{j-1}^m}{h^2}-T_j^m, & 1&\leq j\leq N-1,& m&\geq 0,\label{2.2.213}\\
		e_j^0 &=0, &0 &\leq j\leq N,&\label{2.2.223}\\
		e_0^m &=e_N^m=0, &&&m&\geq 1,\label{2.2.233}.
	\end{empheq}
\end{subequations}
其中, $T_j^m = Tu_j^m$. 对于显式格式, 我们有
\begin{subequations}
	\begin{empheq}[left = {\empheqlbrace}]{align}
		U_j^{m+1} &= \(1-2\mu\)U_j^m+\mu\(U_{j-1}^m +U_{j+1}^m\),\nonumber\\
		e_j^{m+1} &= \(1-2\mu\)e_j^m+\mu\(e_{j-1}^m +e_{j+1}^m\)-\tau T_j^m,\label{3.15}
	\end{empheq}
\end{subequations}
因 $\mu>0$ 且$1 = \(1-2\mu\)+\mu+\mu$, 则要使得最大值原理成立, 只需满足$1-2\mu\geq 0$.  即$\mu\leq \frac{1}{2}$时, 有
\begin{equation*}
	\max_{1\leq j\leq N-1}|U_j^{m}|\leq \max\left\{
	\max_{0\leq j\leq N}| U_j^0|, \max_{1\leq l\leq m}\max\left\{|U_0^l |, |U_N^l |
	\right\}
	\right\}, \quad \forall m\geq 0. 
\end{equation*} 
由 \eqref{3.15} 式以及$\mu\leq \frac{1}{2}$的假设, $e^m$各项系数非负, 且其和不大于$e_j^{m+1}$的系数, 则
\begin{align*}
	|e_j^{m+1}| &\leq \mu|e_{j-1}^m| +\(1-2\mu\)|e_j^m|+\mu |e_{j+1}^m|+\tau |T_j^m|\\
	&\leq \mu \ep ^{m}+\(1-2\mu\)\ep ^{m}+\mu \ep ^{m}+\tau \mathcal{T}^{m}\\
	&=\ep ^{m}+\tau \mathcal{T}^{m}, & 1\leq j\leq N-1,
\end{align*}
其中 $\ep ^m= \max\limits_{0\leq j\leq N} |e_j^m|$, $\mathcal{T}^m = \max\limits_{1\leq j\leq N-1}|T_j^m|$. 由此, 可归纳得到
\begin{align*}
	\ep ^n&\leq \max\left\{\ep ^{n-1}, \max\{|e_0^n |, |e_N^n |\}\right\}+\tau \mathcal{T}^{n-1} \\
	&\leq \max\left\{\ep ^{n-2}, \max_{n-1\leq l\leq n}\max\{|e_0^l |, |e_N^l |\}\right\}+\tau \mathcal{T}^{n-1}+\tau \mathcal{T}^{n-2}\\
	&\leq \cdots \\
	&\leq \max\left\{\ep ^{0}, \max_{1\leq l\leq n}\max\{|e_0^l |, |e_N^l |\}\right\}+\tau\dsum_{k=1}^{n-1}\mathcal{T}^k, 
\end{align*}
此即
\begin{align*}
	\ep ^n &\leq \max\left\{\ep ^{0}, \max_{1\leq l\leq n}\max\{|e_0^l |, |e_N^l |\}\right\}+\(n-1\)\tau \wh{\mathcal{T}}\\
	&\leq \max\left\{\ep ^{0}, \max_{1\leq l\leq n}\max\{|e_0^l |, |e_N^l |\}\right\}+t_{\max}\wh{\mathcal{T}}, 
\end{align*}
其中$\wh{\mathcal{T}} = \max\limits_n \mathcal{T}^n =\|T\|_{\infty, \Omega_{t_{\max}}}$,  则
\begin{equation*}
		\|e\|_{\infty, \Omega_{t_{\max}}} \leq \max\left\{
		\max_{0\leq j\leq N}| e_j^0|, \max_{0< m\tau\leq t_{\max}}\{|e_0^m |+ |e_N^m |\}
		\right\}
	+ t_{\max}\|T\|_{\infty, \Omega_{t_{\max}}} . 
\end{equation*}
该式表明误差方程 \eqref{2.2.213} 在$\mathbb{L}^{\infty}\(\Omega_{t_{\max}}\)$范数意义下是稳定的. 又由于误差$e$满足齐次初边值条件 \eqref{2.2.223} 和 \eqref{2.2.233}, 则在差分格式 \eqref{2.2.8} 的 $\mathbb{L}^{\infty}\(\Omega_{t_{\max}}\)$ 稳定性和相容性条件下, 离散问题 \eqref{2.2} 的解在$\mathbb{L}^{\infty}\(\Omega_{t_{\max}}\)$的意义下收敛到真解. 
特别地, 当$M_{xxxx} $为有界量时, 由 \eqref{2.2.19} 式可得
\begin{equation*}
	\|e\|_{\infty, \Omega_{t_{\max}}} \leq  \tau \(\frac{1}{2}+\frac{1}{12\mu}\)M_{xxxx}  t_{\max}, 
\end{equation*}
但是注意到$t_{\max} \to \infty$时, 以上估计并不能保证格式的收敛性. 我们有下面更精细的估计
\begin{equation}\label{2.xxx}
	\|e\|_{\infty, \Omega_{t_{\max}}}\leq \tau\(\frac{1}{2}+\frac{1}{12\mu}\)M_{xxxx} \min\left\{t_{\max}, \frac{1}{8}\right\}. 
\end{equation}
下面证明 \eqref{2.xxx} 式. 取比较函数
$$\Phi_j^m = t_m\|T\|_{\infty, \Omega_{t_{\max}}},\quad \psi_j^m =\frac{1}{2}x_j\(1-x_j\)\|T\|_{\infty, \Omega_{t_{\max}}}.$$
可以验证
\begin{equation*}
	L_{\(h, \tau\)}\(e_j^m-\Phi_j^m\)\geq 0, \quad L_{\(h, \tau\)}\(e_j^m-\psi_j^m\)\geq 0.
\end{equation*}
事实上
\begin{equation*}
	L_{\(h, \tau\)}\Phi_j^{m}=-\|T\|_{\infty, \Omega_{t_{\max}}}, \quad L_{\(h, \tau\)}\psi_j^m = -\|T\|_{\infty, \Omega_{t_{\max}}},  
\end{equation*}
而
\begin{equation*}
	L_{\(h, \tau\)} e_j^m =T_j^m, 
\end{equation*}
故有
\begin{equation*}
	L_{\(h,\tau\)} \(e_j^m-\Phi_j^m\) = L_{\(h, \tau\)} \(e_j^m-\psi_j^m\) = \|T\|_{\infty, \Omega_{t_{\max}}}+T_j^m\geq 0. 
\end{equation*}
从而由最大值原理
\begin{align*}
	\|e\|_{\infty, \Omega_{t_{\max}}}\leq & \max\left\{
	\max_{0\leq j\leq N}| e_j^0|, \max_{1\leq l\leq m}\max\left\{|e_0^l |, |e_N^l |
	\right\}
	\right\}\\
	&+\min\left\{t_m, \frac{1}{2}x_j\(1-x_j\)\right\}\|T\|_{\infty,\Omega_{t_{\max}}},
\end{align*}
由此可得
\begin{equation*}
	\|e\|_{\infty, \Omega_{t_{\max}}}\leq \tau\(\frac{1}{2}+\frac{1}{12\mu}\)M_{xxxx}  \min\left\{t_{\max}, \frac{1}{8}\right\}
\end{equation*}
成立. 因此$\tau \to 0$时, $\|e\|_{\infty, \Omega_{t_{\max}}} \to 0$, 即显式格式收敛. 

综上所述, 显式格式精度为$O\(\tau+h^2\)$, 且 $0<\mu\leq \frac{1}{2}$时, 在$\mathbb{L}^{\infty}$意义下具有稳定性和收敛性, 收敛速度为$O\(\tau\)$. 
\end{Proof}

\begin{Conclusion}
	显式格式在$0<\mu\leq \frac{1}{2}$时, 有$\mathbb{L}^2$稳定性, 且以$O\(\tau\)$的速度收敛到真解. 
\end{Conclusion}

\begin{Proof}
	考虑离散Fourier变换
	\begin{equation*}
		\begin{cases}
			\wh{V}_k =\dfrac{1}{\sqrt{2}N}\dsum_{j=-N+1}^N V_j \mathrm{e}^{-\mathrm{i}k\pi \frac{j}{N}}, &-N+1\leq k\leq N,\\
			V_j =\dfrac{1}{\sqrt{2}}\dsum_{k=-N+1}^N \wh{V}_k \mathrm{e}^{\mathrm{i}k\pi \frac{j}{N}},&-N+1\leq j\leq N. 
		\end{cases}
	\end{equation*}
其中, $\bm V = \(V_j\)$为网格上的周期函数, 其满足Parseval等式
\begin{equation*}
	\(\frac{1}{N}\dsum_{j=-N+1}^N\left| V_j\right|^2\)^{\frac{1}{2}}=	\|\bm V\|_2 = \|\wh{\bm V}\|_2 = \(\dsum_{k=-N+1}^N\left| \wh{V}_k\right|^2\)^{\frac{1}{2}}, 
\end{equation*}
可知, 对于差分格式
\begin{equation*}
	U_j^{m+1} = \mu U_{j+1}^m +\(1-2\mu\)U_j^m +\mu U_{j-1}^m, \quad \mu=\frac{\tau}{h^2}. 
\end{equation*}
将 Fourier 逆变换代入差分格式中, 有
\begin{equation*}
	\dsum_{k=-N+1}^N \wh{V}_k^{m+1}\mathrm{e}^{\mathrm{i} k\pi \frac{j}{N}} =\dsum_{k=-N+1}^N \wh{V}_k^m \(\mu \mathrm{e}^{\mathrm{i} k\pi \frac{j-1}{N}} +\(1-2\mu\) \mathrm{e}^{\mathrm{i} k\pi \frac{j}{N}} +\mu \mathrm{e}^{\mathrm{i} k\pi \frac{j+1}{N}} \), 
\end{equation*}
对于每一个$k$都有
\begin{align*}
	\wh{V}_k^{m+1} &= \wh{V}_k^m \(\(1-2\mu\)+\mu \(\mathrm{e}^{\mathrm{i} k\pi/N} +\mathrm{e}^{-\mathrm{i} k\pi/N} \)
	\) =\lambda_k \wh{V}_k^m,
\end{align*}
其中
\begin{equation*}
	\lambda_k = 1-4\mu \sin^2\frac{k\pi h}{2}. 
\end{equation*}
要保证格式的稳定性, 需
\begin{equation*}
	\left| \lambda_k^m\right|\leq C, \quad \forall m\tau\leq t_{\max},\quad -N+1\leq k\leq N. 
\end{equation*}
则易知$\mu\leq \frac{1}{2}$时, 由
\begin{equation*}
	4\mu \sin^2\frac{k\pi }{2N}\leq 2
\end{equation*}
可知$|\lambda_k|\leq 1$, 即von Neumann条件成立. 而$\mu>\frac{1}{2}$时, 有
\begin{equation*}
	1-4\mu \sin^2\frac{N\pi}{2N}=1-4\mu<-1, 
\end{equation*}
von Neumann条件不成立. 即$0<\mu\leq \frac{1}{2}$时, 显式格式在$\mathbb{L}^2$意义下稳定, 则
\begin{equation*}
	\|e^{m+1}\|_2\leq \|e^0\|_2+\tau\dsum_{l=0}^m\|T^l\|_2. 
\end{equation*}
注意到, $\tau\dsum_{l=0}^m\|T^l\|_2$可以看作
积分$\dint_0^{\(m+1\)\tau}\|Tu\(\cdot, t\)\|_2\di t$的Riemann和, 因此
\begin{equation*}
	\lim\limits_{\tau \to 0}\dsum_{l=0}^m \|T^l\|_2 = 0, \quad \forall m.
\end{equation*}
综上所述, 显式格式在$0<\mu\leq \frac{1}{2}$时, 有$\mathbb{L}^2$稳定性且以$O\(\tau\)$的速度收敛到真解. 
\end{Proof}

\subsection{隐式格式}

% 对定义在如图$\ref{2}$所示的均匀网格上的网格函数, 
% \begin{figure}[H]
% 	\centering\zihao{-5}
% 	\begin{tikzpicture}[scale=1.0,bullet/.style={circle,fill=#1,inner sep=1.5pt}] 
% 		\draw[step=0.5cm] (0,0) grid (9,4.25) foreach \X in {4,4.5,5} {foreach \Y in {2.5}
% 			{
% 				(\X,\Y) node[bullet=black]{}
% 		}}
% 		(4.5,2) node[bullet=black]{}
% 		(4,-0.1) node[below]{\tiny$j-1$}
% 		(4.5,-0.1) node[below]{\tiny$j$}
% 		(5,-0.1) node[below]{\tiny$j+1$}
% 		(-0.1,2) node[left]{\tiny$m$}
% 		(-0.1,2.5) node[left]{\tiny$m+1$}
% 		(-0.3,-0) node[below]{$O$};
% 		\draw[->]	(0,-0.5) -- (0,4.5) node[above]{$t$};
% 		\draw[->] (-0.5,0) -- (9.5,0) node[right]{$x$};
% 	\end{tikzpicture}
% 	\caption{隐式格式均匀网格示意图}
% 	\label{2}
% \end{figure}
在时间方向用一阶向后差商$\frac{\Delta_{-t}}{\Delta t}$替换时间一阶微商$\frac{\partial }{\partial t}$, 在空间方向用二阶中心差商$\frac{\delta_x^2}{\(\Delta x\)^2}$替换空间二阶微商$\frac{\partial^2}{\partial x^2}$, 就得到了模型问题 \eqref{equ:DirichletProblem} 的最简单的隐式差分格式初边值问题:
\begin{subequations}
	\begin{empheq}[left = {\empheqlbrace}]{align}
		\frac{U_{j}^{m+1}-U_j^m}{\tau } &= \frac{U_{j+1}^{m+1}-2U_j^{m+1}+U_{j-1}^{m+1}}{h^2}, & 1&\leq j\leq N-1, &m\geq 0,\label{2.2.44}\\
		U_j^0 &=u_j^0, &0&\leq j\leq N,&\nonumber\\
		U_0^m &=U_N^m=0, &&&m\geq 1.\nonumber
	\end{empheq}
\end{subequations}
由 \eqref{2.2.44} 式可得
\begin{equation}\label{2.2.47}
	-\mu U_{j-1}^{m+1} +\(1+2\mu\) U_{j+1}^{m+1} -\mu U_{j+1}^{m+1} =U_j^m, \quad \mu=\frac{\tau}{h^2}. 
\end{equation}
这是一个关于$U_j^{m+1}$, $j=1, \cdots, N-1$ 的线性代数方程组, 
系数矩阵%
% \begin{equation}\label{matrix}
% 	A = \begin{pmatrix}
% 		1+2\mu&-\mu&&&\\
% 		-\mu&1+2\mu&-\mu &&\\
% 		&\ddots &\ddots&\ddots&\\
% 		&&-\mu &1+2\mu&-\mu \\
% 		&&&-\mu &1+2\mu
% 	\end{pmatrix}, 
% \end{equation}
% 则
% \begin{equation}\label{equa1}
% 	A\cdot U^{m+1} = U^m, \quad U^m = \(U_1^m, \cdots, U_{N-1}^m\)^T, 
% \end{equation}
% 这
是一个对角占优的三对角正定对称阵, 因此解存在唯一. 
如果已经知道第$m$个时间层$t_m$上的网格函数值$U^m =\{U_j^m\}_{j=0}^N$和边界条件$U_0^{m+1}$, $U_{N}^{m+1}$, 则通过求解线性代数方程组 \eqref{2.2.47} 就可以得到第$m+1$个时间层$t_{m+1}$上的网格函数值$U^{m+1} =\{U_j^{m+1}\}_{j=0}^N$. 
由于新时间层上的网格函数值必须通过联立求解才能从上一时间层的已知网格函数值得到, 所以我们把这样的差分格式称为两时间层向后差分隐式差分格式, 简称隐式格式. 

\subsubsection{隐式格式的截断误差}

引入截断误差算子
\begin{equation}\label{2.2.48}
	T_{\(h, \tau\)} = \(\frac{\Delta_{-t}}{\tau} - \frac{\delta_x^2}{h^2}\) - \(\frac{\partial }{\partial t} - \frac{\partial^2}{\partial x^2}\).
\end{equation}
设$u$是定义在$\(0, 1\)\times \mathbb{R}_+$上的充分光滑的函数, 由$u$在点$\(x, t\)$的Taylor展开式
\begin{align*}
	\Delta_{-t} u\(x, t\) & :=  u\(x, t\) - u\(x, t-\Delta t\) \\
	&~= u_t\(x, t\)\Delta t-\frac{1}{2}u_{tt}\(x, t\)\(\Delta t\)^2+\frac{1}{6}u_{ttt}\(x, t\)(\Delta t^3)+\cdots, \\
	\delta_x^2 u(x, t) & :=  u\(x+\Delta x, t\) - 2u\(x, t\)+u\(x-\Delta x, t\) \\
	&~= u_{xx}\(x, t\)\(\Delta x\)^2+\frac{1}{12}u_{xxxx}\(x, t\)\(\Delta x\)^4+\cdots, 
\end{align*}
有
\begin{align}\label{2.2.49}
	T u\(x, t\) = -\frac{1}{2}u_{tt}\(x, t\)\tau-\frac{1}{12}u_{xxxx}\(x, t\)h^2+O\(\tau^2+h^4\), 
\end{align}
或
\begin{align}\label{2.2.50}
	T u\(x, t\) = -\frac{1}{2}u_{tt}\(x, \tau\)\tau-\frac{1}{12}u_{xxxx}\(\xi, t\)h^2,
\end{align}
其中$\eta\in \(t-\tau, t\)$, $\xi \in \(x-\frac{h}{2}, x+\frac{h}{2}\)$. 
由此可知
\begin{equation*}
	\lim\limits_{h \to 0, \tau \to 0}T_{\(h, \tau\) } = 0, 
\end{equation*}
即差分格式是相容的, 且其局部截断误差关于时间和空间分别具有一阶和二阶精度, 即
\begin{equation*}
	Tu\(x, t\) = O\(\tau+h^2\). 
\end{equation*}

\subsubsection{隐式格式的稳定性, 收敛性分析}

\begin{Conclusion}
	隐式格式无条件$\mathbb{L}^{\infty}$稳定且收敛, 精度为 $O\(\tau+h^2\)$.
\end{Conclusion}

\begin{Proof}
	将差分格式改写为
\begin{subequations}
	\begin{empheq}[left = {\empheqlbrace}]{align}
		\(1+2\mu\)U_j^{m+1} &= \mu\(U_{j-1}^{m+1}+U_{j+1}^{m+1}\)+U_j^m\label{1111}\\
		\(1+2\mu\)e_j^{m+1} &=\mu\(e_{j-1}^{m+1}+e_{j+1}^{m+1}\) +e_j-\tau T_j^{m+1},\label{1112}
	\end{empheq}
\end{subequations}
则对任意的$\mu>0$,  \eqref{1111} 式右端各项系数大于零且其和等于左边系数, 满足最大值原理. 从而
\begin{equation*}
	\max_{1\leq j\leq N-1}|U_j^{m}|\leq \max\left\{
	\max_{0\leq j\leq N}| U_j^0|, \max_{1\leq l\leq m}\max\left\{|U_0^l |, |U_N^l |
	\right\}
	\right\}, \quad \forall m\geq 0. 
\end{equation*} 
又由 \eqref{1112} 式归纳可得
\begin{equation*}
	\max_{1\leq j\leq N-1}|e_j^{m+1}|\leq \max\left\{ \max_{0\leq j\leq N}\{|e_j^0|\}, \max_{0\leq l\leq m+1}\max\{|e_0^l|, |e+N^l|\}
	\right\}+\tau\dsum_{l=1}^{m+1}T^l, 
\end{equation*}
由此, 隐式格式无条件$\mathbb{L}^{\infty}$稳定. 进一步, 取
$$\phi_j^m = t_m\|T\|_{\infty, \Omega_{t_{\max}}},\quad \psi_j^m = \frac{1}{2}x_j\(1-x_j\)\|T\|_{\infty, \Omega_{t_{\max}}}.$$
记
\begin{equation*}
	L_{\(h, \tau\)} = \frac{\delta_x^2}{h^2} - \frac{\Delta_{-t}}{\Delta t}, 
\end{equation*}
可以验证
\begin{equation*}
	L_{\(h, \tau\)}\(e_j^{m+1}-\phi_j^{m+1}\)\geq 0, \quad L_{\(h, \tau\)}\(e_j^{m+1}-\psi_j^{m+1}\)\geq 0,
\end{equation*}
即最大值原理成立, 因此
\begin{align*}
	\|e\|_{\infty, \Omega_{t_{\max}}}\leq ~&\max\left\{
	\max_{0\leq j\leq N}| e_j^0|, \max_{1\leq l\leq m}\max\left\{|e_0^l |, |e_N^l |\right\}\right\}\\
	&+\min\left\{t_m, \frac{1}{2}x_j\(1-x_j\)\right\}\|T\|_{\infty,\Omega_{t_{\max}}},
\end{align*}
由此可得
\begin{equation*}
	\|e\|_{\infty, \Omega_{t_{\max}}}\leq \tau\(\frac{1}{2}+\frac{1}{12\mu}\)M_{xxxx} \min\left\{t_{\max}, \frac{1}{8}\right\}
\end{equation*}
成立. 于是 $\tau \to 0$时, $\|e\|_{\infty, \Omega_{t_{\max}}} \to 0$. 

综上所述, 隐式格式无条件$\mathbb{L}^{\infty}$稳定且收敛, 逼近精度为$O\(\tau+h^2\)$. 
\end{Proof}

\begin{Conclusion}
	隐式格式无条件$\mathbb{L}^2$稳定且收敛, 逼近精度为$O\(\tau+h^2\)$. 
\end{Conclusion}

\begin{Proof}
	对于差分格式
	\begin{equation*}
	-\mu U_{j-1}^{m+1}+	\(1+2\mu\)U_j^{m+1}-\mu 
	U_{j+1}^{m+1} = U_j^m,
	\end{equation*}
	将Fourier波型$U_j^m=\lambda_k^m\mathrm{e}^{\mathrm{i}k\pi jh}$代入格式中可得
	\begin{equation*}
		-\mu\lambda_k^{m+1}\mathrm{e}^{\mathrm{i}k\pi \(j-1\)h} +\(1+2\mu\)\lambda_k^{m+1}\mathrm{e}^{\mathrm{i}k\pi jh}-\mu\lambda_k^{m+1}\mathrm{e}^{\mathrm{i}k\pi \(j+1\)h} =\lambda_k^m \mathrm{e}^{\mathrm{i}k\pi jh}. 
	\end{equation*}
	% 即
	% \begin{equation*}
	% 	-\mu\lambda_k\(\cos k\pi h-\mathrm{i}\sin k\pi h\)+\(1+2\mu \)\lambda_k-\mu\lambda_k\(\cos k\pi h+\mathrm{i}\sin k\pi h\)=1. 
	% \end{equation*}
	于是增长因子为
	\begin{equation*}
		\lambda_k = \frac{1}{1+4\mu \sin^2 \frac{k\pi h}{2}}, 
	\end{equation*}
	则 $|\lambda_k|\leq 1$, 满足von Neumann条件, 即隐式格式无条件$\mathbb{L}^2$稳定. 类似地, 隐式格式收敛. 

	综上所述, 隐式格式无条件$\mathbb{L}^2$稳定且收敛, 逼近精度为$O\(\tau+h^2\)$. 
\end{Proof}

\subsection{Crank-Nicolson 格式}

% 对定义在如图$\ref{3}$所示的均匀网格上的网格函数, 
% \begin{figure}[H]
% 	\centering\zihao{-5}
% 	\begin{tikzpicture}[scale=1.0,bullet/.style={circle,fill=#1,inner sep=1.5pt}] 
% 		\draw[step=0.5cm] (0,0) grid (9,4.25) foreach \X in {4,4.5,5} {foreach \Y in {2}
% 			{
% 				(\X,\Y) node[bullet=black]{}
% 		}}
% 		(4.5,2.5) node[bullet=black]{}
% 		(4,2.5) node[bullet=black]{}
% 		(5,2.5) node[bullet=black]{}
% 		(4,-0.1) node[below]{\tiny$j-1$}
% 		(4.5,-0.1) node[below]{\tiny$j$}
% 		(5,-0.1) node[below]{\tiny$j+1$}
% 		(-0.1,2) node[left]{\tiny$m$}
% 		(-0.1,2.5) node[left]{\tiny$m+1$}
% 		(-0.3,-0) node[below]{$O$};
% 		\draw[->]	(0,-0.5) -- (0,4.5) node[above]{$t$};
% 		\draw[->] (-0.5,0) -- (9.5,0) node[right]{$x$};
% 	\end{tikzpicture}
% 	\caption{Crank-Nicolson 格式均匀网格示意图}
% 	\label{3}
% \end{figure}
在点$\(x, t+\frac{1}{2}\Delta t\)$采用关于时间的一阶中心差商$\frac{\delta_t}{\Delta t}$替换一阶微商$\frac{\partial }{\partial t}$, 用$\(x, t+\Delta t\)$和$\(x, t\)$两点的关于空间的二阶中心差商$\frac{\delta_x^2}{\(\Delta x\)^2}$的平均值替换二阶微商$\frac{\partial^2}{\partial x^2}$, 就得到了模型问题 \eqref{equ:DirichletProblem} 的 Crank-Nicolson 格式初边值问题:
\begin{equation*}
	\lb\begin{aligned}
		\frac{U_{j}^{m+1}-U_j^m}{\tau } &=\frac{1}{2} \(\frac{U_{j+1}^m-2U_j^m+U_{j-1}^m}{h^2}\rd\\
		&\quad \ld +\frac{U_{j+1}^{m+1}-2U_j^{m+1}+U_{j-1}^{m+1}}{h^2}
		\), & 1&\leq j\leq N-1, &m&\geq 0,\\
		U_j^0 &=u_j^0, &0&\leq j\leq N,&&\\
		U_0^m &=U_N^m=0, &&&m&\geq 1.
	\end{aligned}\rd
\end{equation*}

\subsubsection{Crank-Nicolson 格式的截断误差}

引入截断误差算子
\begin{equation*}
	T_{\(h, \tau\)} = \(\frac{\delta_{t}}{\tau} - \frac{\delta_x^2}{h^2}\) - \(\frac{\partial }{\partial t} - \frac{\partial^2}{\partial x^2}\).
\end{equation*}
设$u$是定义在$\(0, 1\)\times \mathbb{R}_+$上的充分光滑的函数, 由$u$在点$\(x, t+\frac{1}{2}\Delta t\)$的Taylor展开式
\begin{align*}
	\delta_{t} u\(x, t\) & :=  u(x, t+\Delta t) - u(x, t) \\
	&~= u_t\(x, t+\frac{1}{2}\Delta t\)\Delta t+\frac{1}{24}u_{ttt}\(x, t+\frac{1}{2}\Delta t\)\(\Delta t\)^3+\cdots.
\end{align*}
由$u$在点$\(x, t\) $的Taylor展开式
\begin{align*}
	\mathcal{A} u(x, t) & :=  -\frac{u\(x-\Delta x, t\) -2u\(x, t\)+u\(x+\Delta x, t\)}{\Delta x^2} \\
	&~=-\(u_{xx}\(x, t\)+\frac{1}{12}u_{xxxx}\(x, t\)\Delta x^2\)+\cdots
\end{align*}
现将右端的每一项在$\(x, t+\frac{1}{2}\Delta t\)$ 处 Taylor 展开得
\begin{align*}
	\mathcal{A} u(x, t) %=-\(u_{xx}\(x, t\)+\frac{1}{12}u_{xxxx}\(x, t\)\Delta x^2\)+\cdots \\
	=&-\(u_{xx}(x, t+\frac{1}{2}\Delta t)+\frac{1}{12}u_{xxxx}(x, t+\frac{1}{2}\Delta t)\Delta x^2\)+\cdots \\
	&+\frac{\Delta t}{2}\( u_{xxt}(x, t+\frac{1}{2}\Delta t)+\frac{1}{12}u_{xxxxt}(x, t+\frac{1}{2}\Delta t)\Delta x^2 \)+\cdots  \\
	&-\frac{1}{2}\(\frac{\Delta t}{2}\)^2 \(u_{xxtt}(x, t+\frac{1}{2}\Delta t)+\frac{1}{12} u_{xxxxtt}(x, t+\frac{1}{2}\Delta t)\Delta x^2\) +\cdots 
\end{align*}
同理可得
\begin{align*}
	\mathcal{A} u(x, t+\Delta t) %&=-[u_{xx}(x, t+\Delta t)+\frac{1}{12}u_{xxxx}(x, t+\Delta t)\Delta x^2]+\cdots \\
	=&-\( u_{xx}(x, t+\frac{1}{2}\Delta t)+\frac{1}{12}u_{xxxx}(x, t+\frac{1}{2}\Delta t)\Delta x^2 \)+\cdots \\
	&-\frac{\Delta t}{2} \(u_{xxt}(x, t+\frac{1}{2}\Delta t)+\frac{1}{12}u_{xxxxt}(x, t+\frac{1}{2}\Delta t)\Delta x^2 \)+\cdots  \\
	& -\frac{1}{2}\(\frac{\Delta t}{2}\)^2 \(u_{xxtt}(x, t+\frac{1}{2}\Delta t)+\frac{1}{12} u_{xxxxtt}(x, t+\frac{1}{2}\Delta t)\Delta x^2\) +\cdots 
\end{align*}
由$u_t = u_{xx}$可知 Crank-Nicolson 格式的局部截断误差为
\begin{equation*}
	T_j^{m+\frac{1}{2}}  :=  Tu\(x_j, t_{m+\frac{1}{2}}\) =-\frac{1}{12}\left( u_{ttt}\tau^2+u_{xxxx}h^2\right)_j^{m+\frac{1}{2}}+O\(\tau^4+h^4\), 
\end{equation*}
或
\begin{equation*}
	T_j^{m+\frac{1}{2}}  :=  Tu\(x_j, t_{m+\frac{1}{2}}\) =-\frac{1}{12}\left(u_{ttt}\(x_j, \eta\)\tau^2+u_{xxxx}\(\xi, t_{m+\frac{1}{2}}\)h^2\right). 
	\end{equation*}
其中$\eta\in \(t, t+\tau\)$, $\xi\in \(x-h, x+h\)$. 由此可知
\begin{equation*}
	\lim\limits_{h \to 0, \tau \to 0}T_{\(h, \tau\) } = 0, 
\end{equation*}
即差分格式是相容的, 且其局部截断误差关于时间和空间分别具有二阶和二阶精度, 即
\begin{equation*}
	Tu\(x, t\) = O\(\tau^2+h^2\). 
\end{equation*}

\subsubsection{Crank-Nicolson 格式的稳定性, 收敛性分析}

\begin{Conclusion}
	$0<\mu\leq 1$ 时, Crank-Nicolson 格式$\mathbb{L}^{\infty}$稳定且收敛, 精度为$O\(\tau^2+h^2\)$. 
\end{Conclusion}

\begin{Proof}
	将差分格式改写为
	\begin{equation*}
			\(1+\mu\)U_j^{m+1} =\(1-\mu\) U_j^{m}+\frac{\mu}{2}\(U_{j-1}^m+U_{j+1}^m+U_{j-1}^{m+1}+U_{j}^{m+1}\),
	\end{equation*}
	易知$1-\mu\geq 0$时, 满足最大值原理. 从而
		\begin{equation*}
			\max_{1\leq j\leq N-1}|e_j^{m+1}|\leq \max\left\{ \max_{0\leq j\leq N}\{|e_j^0|\}, \max_{0\leq l\leq m+1}\max\{|e_0^l|, |e_N^l|\}
			\right\}+\tau\dsum_{l=1}^{m+1}T^l, 
		\end{equation*}
	即$\mu\leq 1$时,  Crank-Nicolson 格式$\mathbb{L}^{\infty}$稳定. 进一步, 取
	$$\phi_j^m = t_m\|T\|_{\infty, \Omega_{t_{\max}}},\quad  \psi_j^m = \frac{1}{2}x_j\(1-x_j\)\|T\|_{\infty, \Omega_{t_{\max}}}.$$
	记
	\begin{equation*}
		L_{\(h, \tau\)} := \frac{\delta_x^2}{h^2} - \frac{\delta_{t}}{\Delta t}.
	\end{equation*}
	可以验证
	\begin{equation*}
		L_{\(h, \tau\)}\(e_j^{m+1}-\phi_j^{m+1}\)\geq 0, \quad L_{\(h, \tau\)}\(e_j^{m+1}-\psi_j^{m+1}\)\geq 0,
	\end{equation*}
	即最大值原理成立, 因此
	\begin{align*}
		\|e\|_{\infty, \Omega_{t_{\max}}}\leq &\max\left\{
		\max_{0\leq j\leq N}| e_j^0|, \max_{1\leq l\leq m}\max\left\{|e_0^l |, |e_N^l |
		\right\}\right\}\\
		&+\min\left\{t_m, \frac{1}{2}x_j\(1-x_j\)\right\}\|T\|_{\infty,\Omega_{t_{\max}}}.
	\end{align*}
	由此可得
	\begin{equation*}
		\|e\|_{\infty, \Omega_{t_{\max}}}\leq \frac{1}{12}\(M_{ttt}\tau^2+M_{xxxx}h^2\) \min\left\{t_{\max}, \frac{1}{8}\right\}
	\end{equation*}
	成立. 因此$\tau \to 0$时, $\|e\|_{\infty, \Omega_{t_{\max}}} \to 0$. 
	
	综上所述,  Crank-Nicolson 格式在$0<\mu\leq 1$时, $\mathbb{L}^{\infty}$稳定且收敛, 精度为$O\(\tau^2+h^2\)$. 
\end{Proof}

\begin{Conclusion}
	 Crank-Nicolson 格式无条件$\mathbb{L}^2$稳定且收敛, 精度为$O\(\tau^2+h^2\)$. 
\end{Conclusion}

\begin{Proof}
	将Fourier波型$U_j^m=\lambda_k^m\mathrm{e}^{\mathrm{i}k\pi jh}$代入差分格式中可得
	\begin{equation*}
	\lambda_k = \frac{1-2\mu\sin^2\frac{k\pi h}{2}}{1+2\mu \sin^2\frac{k\pi h}{2}}, 
	\end{equation*}
	则 $|\lambda_k|\leq 1$, 满足von Neumann条件, 即 Crank-Nicolson 格式无条件$\mathbb{L}^2$稳定. 进一步
	\begin{equation*}
		\|e^m\|_2 = O\(\tau^2\), 
	\end{equation*}
	二阶收敛. 

	综上所述,  Crank-Nicolson 格式无条件$\mathbb{L}^2$稳定且收敛, 逼近精度为$O\(\tau^2+h^2\)$. 
\end{Proof}

\section{数值实验}

\subsection{显式格式}

下面我们考虑$[0,1]\times \mathbb{R}_+$上的问题:
\begin{subequations}\label{solu}
	\begin{empheq}[left = {\empheqlbrace}]{align}
		u_t &= \frac{1}{2} u_{xx}, & 0&<x<1, &t>0,\label{solu1}\\
		u\(x, 0\) &= \sin\(\pi x\), &0&\leq x\leq 1,&\label{solu2}\\
		u\(0, t\) &= u\(1, t\) =0, &&&t>0\label{solu3}.
	\end{empheq}
\end{subequations}
由 \eqref{2.2.7} 式可知, 其解析解为
\begin{equation*}
	u\(x, t\) = \mathrm{e}^{-\frac{1}{2}\pi^2 t}\sin\(\pi x\). 
\end{equation*}
由显式差分格式 \eqref{2.2.8} 以及边值条件 \eqref{solu2}, \eqref{solu3} 可得
\begin{subequations}
	\begin{empheq}[left = {\empheqlbrace}]{align}
		U_{j}^{m+1} &=\(1-2\mu\)U_j^m+\mu\(U_{j-1}^m+U_{j+1}^m\),& 1 &\leq j\leq N-1, &m&\geq 0,\nonumber\\
		U_j^0 &=\sin\(jh\pi\), & 0 &\leq j\leq N,&&\nonumber\\
		U_0^m &=U_N^m=0, &&&m&\geq 1,\nonumber
	\end{empheq}
\end{subequations}
其中 $\mu = \dfrac{a\tau}{h^2}$.

\subsubsection{稳定性条件成立}

取定$t_{\max} =1$. 令$\mu = 0.25\leq 0.5$, 满足稳定性条件, 数值实验结果如表 \ref{tab:expliciterr1} 所示.
\begin{table}[H]\centering\heiti\zihao{-5}
	\caption{显式格式不同步长时的 $\mathbb{L}^2$, $\mathbb{L}^\infty$ 误差及收敛阶}\label{tab:expliciterr1}
	\begin{tabular}{|c|c|c|c|c|}\hline
		收敛阶	&	$\mathbb{L}^2$ 误差	&	$h$	&	$\mathbb{L}^\infty$ 误差		&	收敛阶\\\hline			&	$1.5871 \times 10^{-3}$	&	$2^3$	&	$2.3807 \times 10^{-3}$	&	\\\hline
		$1.9665$	&	$4.0611 \times 10^{-4}$	&	$2^4$	&	$5.9200 \times 10^{-4}$	&	$2.0077$\\\hline
		$1.9804$	&	$1.0292 \times 10^{-4}$	&	$2^5$	&	$1.4780 \times 10^{-4}$	&	$2.0019$\\\hline
		$1.9895$	&	$2.5918 \times 10^{-5}$	&	$2^6$	&	$3.6939 \times 10^{-5}$	&	$2.0005$\\\hline
		$1.9946$	&	$6.5040 \times 10^{-6}$	&	$2^7$	&	$9.2339 \times 10^{-6}$	&	$2.0001$\\\hline
		$1.9972$	&	$1.6291 \times 10^{-6}$	&	$2^8$	&	$2.3084 \times 10^{-6}$	&	$2.0000$\\\hline
		$1.9986$	&	$4.0768 \times 10^{-7}$	&	$2^9$	&	$5.7711 \times 10^{-7}$	&	$2.0000$\\\hline
		$1.9993$	&	$1.0197 \times 10^{-7}$	&	$2^{10}$	&	$1.4428 \times 10^{-7}$	&	$2.0000$\\\hline
		$1.9997$	&	$2.5498 \times 10^{-8}$	&	$2^{11}$	&	$3.6069 \times 10^{-8}$	&	$2.0000$\\\hline		
	\end{tabular}
\end{table}
\noindent 由结果可以看出解序列逐步收敛到模型问题 \eqref{solu} 的解, 且收敛阶趋于 $2$, 与理论结果相符.
%   数值解$U_{i,j}$与$u_{i,j}$在$t = t_{\max}$时刻图像如图 所示.

% \begin{figure}[H]\centering
% 	% \resizebox{0.9\linewidth}{!}{\input{unknown1.pgf}}
% 	\caption{$h = 2^{-5}$ 时差分逼近解}\label{fig:explicit1}
% \end{figure}

\subsubsection{稳定性条件不成立}

在数值实验中, 取定$t_{\max} =1$. 令$\mu = 0.51>0.5$, 不满足稳定性条件. 
计算$\mathbb{L}^{\infty}$与$\mathbb{L}^{2}$误差可知, 在不满足稳定性条件时, 显式格式所求得的数值解不收敛. 
\begin{table}[H]\centering\heiti\zihao{-5}
	\caption{显式格式不同步长时的 $\mathbb{L}^2$, $\mathbb{L}^\infty$ 误差及收敛阶}\label{tab:expliciterr2}
	\begin{tabular}{|c|c|c|c|c|}\hline
		收敛阶	&	$\mathbb{L}^2$ 误差	&	$h$	&	$\mathbb{L}^\infty$ 误差		&	收敛阶\\\hline	&	$9.9655\times10^{-3}$	&	$2^3$	&	$7.0467\times10^{-3}$	&	\\\hline
		$2.0229$	&	$2.4522\times10^{-3}$	&	$2^4$	&	$1.7340\times10^{-3}$	&	$2.02286$\\\hline
		$-3.3210$	&	$2.4507\times10^{-2}$	&	$2^5$	&	$1.7288\times10^{-2}$	&	$-3.31758$\\\hline
		$-171.0$	&	$7.3858\times10^{49}$	&	$2^6$	&	$5.2225\times10^{49}$	&	$-171.013$\\\hline
		$-680.7$	&	$5.8712\times10^{254}$	&	$2^7$	&	$4.1516\times10^{254}$	&	$-680.664$\\\hline
		$-\infty$	&	$\infty$	&	$2^8$	&	$\infty$	&	$-\infty$\\\hline
	\end{tabular}
\end{table}
% 数值解$U_{i,j}$与$u_{i,j}$在$t = t_{\max}$时刻图像如下所示, 
% \begin{figure}[H]\centering
% 	% \resizebox{0.9\linewidth}{!}{\input{unknown1.pgf}}
% 	\caption{$h = 2^{-5}$ 时差分逼近解}\label{fig:explicit2}
% \end{figure}

\subsection{隐式格式}

仍考虑问题 \eqref{solu}. 由隐式差分格式$\(\ref{2.2.44}\)$以及边值条件可得
\begin{subequations}
	\begin{empheq}[left = {\empheqlbrace}]{align}
		-\mu U_{j-1}^{m+1} +\(1+2\mu\) U_{j+1}^{m+1}-\mu U_{j+1}^{m+1} &=U_j^m& 1 &\leq j\leq N-1,& m&\geq 0,\nonumber\\
		U_j^0 &=\sin\(jh\pi\), &0 &\leq j\leq N,&&\nonumber\\
		U_0^m &=U_N^m=0, &&&m&\geq 1.\nonumber
	\end{empheq}
\end{subequations}
写为矩阵形式
\begin{equation*}
	AU^{m+1} = U^m, \quad m\geq 0, 
\end{equation*}
其中
\begin{equation*}
	A = \begin{pmatrix}
		1+2\mu&-\mu&&&\\
		-\mu&1+2\mu&-\mu &&\\
		&\ddots &\ddots&\ddots&\\
		&&-\mu &1+2\mu&-\mu \\
		&&&-\mu &1+2\mu
	\end{pmatrix},\quad U^m = \(U_1^m, \cdots, U_{N-1}^m\)^\T. 
\end{equation*}

取定$t_{\max} = 1.0$. 令$\mu = 0.25$, 利用 LU 分解求解方程, 求出误差阶如表 \ref{tab:imexpliciterr2} 所示.
\begin{table}[H]\centering\heiti\zihao{-5}
	\caption{隐式格式不同步长时的 $\mathbb{L}^2$, $\mathbb{L}^\infty$ 误差及收敛阶}\label{tab:imexpliciterr2}
	\begin{tabular}{|c|c|c|c|c|}\hline
		收敛阶	&	$\mathbb{L}^2$ 误差	&	$h$	&	$\mathbb{L}^\infty$ 误差		&	收敛阶\\\hline
			&	$7.7496 \times 10^{-3}$	&	$2^3$	&	$1.1624 \times 10^{-2}$	&	\\\hline
		$1.9409$	&	$2.0185 \times 10^{-3}$	&	$2^4$	&	$2.9424 \times 10^{-3}$	&	$1.9821$\\\hline
		$1.9739$	&	$5.1382 \times 10^{-4}$	&	$2^5$	&	$7.3792 \times 10^{-4}$	&	$1.9955$\\\hline
		$1.9879$	&	$1.2954 \times 10^{-4}$	&	$2^6$	&	$1.8463 \times 10^{-4}$	&	$1.9989$\\\hline
		$1.9942$	&	$3.2517 \times 10^{-5}$	&	$2^7$	&	$4.6165 \times 10^{-5}$	&	$1.9997$\\\hline
		$1.9971$	&	$8.1455 \times 10^{-6}$	&	$2^8$	&	$1.1542 \times 10^{-5}$	&	$1.9999$\\\hline
		$1.9986$	&	$2.0384 \times 10^{-6}$	&	$2^9$	&	$2.8855 \times 10^{-6}$	&	$2.0000$\\\hline
		$1.9992$	&	$5.0986 \times 10^{-7}$	&	$2^{10}$	&	$7.2141 \times 10^{-7}$	&	$2.0000$\\\hline
		$1.9989$	&	$1.2757 \times 10^{-7}$	&	$2^{11}$	&	$1.8045 \times 10^{-7}$	&	$1.9992$\\\hline
	\end{tabular}
\end{table}

由数值结果可以看出解序列逐步收敛到模型问题 \eqref{solu} 的解, 且收敛阶趋于$2$, 与理论结果相符.
%   数值解$U_{i,j}$与$u_{i,j}$在$t = t_{\max}$时刻图像如下所示, 

\subsection{Crank-Nicolson 格式}

仍考虑问题 \eqref{solu}. 由 Crank-Nicolson 格式以及边值条件可得
$$\lb\begin{aligned}
	\(1+\mu\)U_j^{m+1} &= \(1-\mu\)U_j^m &&&&\\
	&\quad +\frac{\mu}{2}\(U_{j-1}^m +U_{j+1}^m+U_{j-1}^{m+1}+U_{j+1}^{m+1}\),& 1&\leq j\leq N-1,& m&\geq 0,\\
	U_j^0 &=\sin\(jh\pi\), &0&\leq j\leq N,&&\\
	U_0^m &= U_N^m=0, &&&m&\geq 1.
\end{aligned}\rd$$
写为矩阵形式
\begin{equation*}
	AU^{m+1} = BU^m,\quad U^m = \(U_1^m, \cdots, U_{N-1}^m\)^\T, \quad m\geq 0, 
\end{equation*}
其中
\begin{equation*}
	A = \begin{pmatrix}
		1+\mu&-\frac{\mu}{2}&&&\\
		-\frac{\mu}{2}&1+\mu&-\frac{\mu}{2} &&\\
		&\ddots &\ddots&\ddots&\\
		&&-\frac{\mu}{2} &1+\mu&-\frac{\mu}{2} \\
		&&&-\frac{\mu}{2} &1+\mu
	\end{pmatrix},\quad B = \begin{pmatrix}
	1-\mu&\frac{\mu}{2}&&&\\
	\frac{\mu}{2}&1-\mu&\frac{\mu}{2} &&\\
	&\ddots &\ddots&\ddots&\\
	&&\frac{\mu}{2} &1-\mu&\frac{\mu}{2} \\
	&&&\frac{\mu}{2} &1-\mu
\end{pmatrix}.
\end{equation*}

\subsubsection{稳定性条件成立}

取 $t_{\max} =1$. 令$\mu = 0.25 \leq 1$, 满足$\mathbb{L}^{\infty}$, $\mathbb{L}^2$稳定性条件. 利用 LU 分解求解方程, 求出误差阶如表 \ref{tab:cnerr1} 所示.
\begin{table}[H]\centering\heiti\zihao{-5}
	\caption{Crank-Nicolson 格式不同步长时的 $\mathbb{L}^2$, $\mathbb{L}^\infty$ 误差及收敛阶}\label{tab:cnerr1}
	\begin{tabular}{|c|c|c|c|c|}\hline
		收敛阶	&	$\mathbb{L}^2$ 误差	&	$h$	&	$\mathbb{L}^\infty$ 误差		&	收敛阶\\\hline
		&	$3.1262 \times 10^{-3}$	&	$2^3$		&	$4.6892 \times 10^{-3}$	&	\\\hline
		$1.9500$	&	$8.0910 \times 10^{-4}$	&	$2^4$		&	$1.1795 \times 10^{-3}$	&	$1.9912$\\\hline
		$1.9762$	&	$2.0564 \times 10^{-4}$	&	$2^5$		&	$2.9532 \times 10^{-4}$	&	$1.9978$\\\hline
		$1.9884$	&	$5.1823 \times 10^{-5}$	&	$2^6$		&	$7.3860 \times 10^{-5}$	&	$1.9994$\\\hline
		$1.9943$	&	$1.3007 \times 10^{-5}$	&	$2^7$		&	$1.8467 \times 10^{-5}$	&	$1.9999$\\\hline
		$1.9972$	&	$3.2582 \times 10^{-6}$	&	$2^8$		&	$4.6168 \times 10^{-6}$	&	$2.0000$\\\hline
		$1.9986$	&	$8.1535 \times 10^{-7}$	&	$2^9$		&	$1.1542 \times 10^{-6}$	&	$2.0000$\\\hline
		$1.9992$	&	$2.0395 \times 10^{-7}$	&	$2^{10}$	&	$2.8857 \times 10^{-7}$	&	$1.9999$\\\hline
		$1.9983$	&	$5.1048 \times 10^{-8}$	&	$2^{11}$	&	$7.2210 \times 10^{-8}$	&	$1.9987$\\\hline
	\end{tabular}
\end{table}
可以看出解序列逐步收敛到模型问题 \eqref{solu} 的解, 且收敛阶趋于$2$, 与理论结果相符.
%   数值解$U_{i,j}$与$u_{i,j}$在$t = t_{\max}$时刻图像如下所示, 

\subsubsection{稳定性条件不成立}

在数值实验中, 取定$t_{\max} =1$. 令$\mu =10> 1$, 不满足$\mathbb{L}^{\infty}$稳定性条件, 满足$\mathbb{L}^2$稳定性条件. 利用 LU 分解求解方程, 求出误差阶如表 \ref{tab:cnerr2} 所示.
\begin{table}[H]\centering\heiti\zihao{-5}
	\caption{Crank-Nicolson 格式不同步长时的 $\mathbb{L}^2$, $\mathbb{L}^\infty$ 误差及收敛阶}\label{tab:cnerr2}
	\begin{tabular}{|c|c|c|c|c|}\hline
		收敛阶	&	$\mathbb{L}^2$ 误差	&	$h$	&	$\mathbb{L}^\infty$ 误差		&	收敛阶\\\hline
		&	$3.9675\times10^{-5}$	&	$2^6$	&	$5.6109\times10^{-5}$	&	\\\hline
		$1.6927$	&	$1.2273\times10^{-5}$	&	$2^7$	&	$1.7357\times10^{-5}$	&	$1.6927$\\\hline
		$1.9325$	&	$3.2154\times10^{-6}$	&	$2^8$	&	$4.5473\times10^{-6}$	&	$1.9325$\\\hline
		$1.9836$	&	$8.1308\times10^{-7}$	&	$2^9$	&	$1.1499\times10^{-6}$	&	$1.9836$\\\hline
		$1.9959$	&	$2.0384\times10^{-7}$	&	$2^{10}$	&	$2.8828\times10^{-7}$	&	$1.9959$\\\hline
		$1.9991$	&	$5.0992\times10^{-8}$	&	$2^{11}$	&	$7.2114\times10^{-8}$	&	$1.9991$\\\hline
	\end{tabular}
\end{table}
可以看出, 对于此问题模型, 解序列逐步收敛到模型问题 \eqref{solu} 的解, 且收敛阶趋于$2$.
%  数值解$U_{i,j}$与$u_{i,j}$在$t = t_{\max}$时刻图像如下所示, 

\section{二维抛物型方程 Crank-Nicolson 格式}

\subsection{模型问题}

考虑 $\Omega := (0, X) \times (0, Y)$ 上的热传导方程的 Dirichlet 初边值问题:
\begin{equation}\label{equ:2d_DirichletProblem}
	\lb\begin{aligned}
		u_t &= a\(u_{xx} + u_{yy}\),	&	(x, y) \in \Omega,&~t > 0,	\\
		u(x, y, 0) &= u^0(x, y),	&	0 \leq x \leq 1,&	\\
		u(x, y, t) &= 0,	&	&~t > 0.
	\end{aligned}\rd
\end{equation}
其中 $a > 0$ 是热扩散系数.

\subsection{差分逼近}

与一维情形类似, 在 $\Omega\times \R_+$ 上引入网格. 任取正整数 $N_x$ 和 $N_y$, 采用均匀时空网格:
\begin{align*}
	h_x &= \D x = \dfrac{X}{N_x},& h_y &= \D y = \dfrac{Y}{N_y},& \D t = \tau,\\
	x_j &= jh,& j &= 0, 1, \cdots, N_x,\\
	y &= kh,& k &= 0, 1, \cdots, N_y,\\
	t_m &= m\tau,& m &= 0, 1, \cdots,
\end{align*}
其网格节点集为
$$J := \lrb{\(x_j, y_k, t_m\):\quad j = 0, 1, \cdots, N_x,\quad k = 0, 1, \cdots, N_y,\quad m = 0, 1, \cdots},$$
常将 $\(x_j, y_k, t_m\)$ 简记为 $(j, k, m)$. 在网格上定义网格函数
$$U_{(h_x, h_y, \tau)} := \lrb{U_{jk}^m:\quad j = 0, 1, \cdots, N_x,\quad k = 0, 1, \cdots, N_y,\quad m = 0, 1, \cdots}$$
模型问题 \eqref{equ:2d_DirichletProblem} 的真解在 $(j, k, m)$ 上的取值记为 $u_{j,k}^m$. 下面使用 Crank-Nicolson 格式求解模型问题, 并分析稳定性, 收敛性和误差.

\begin{comment}
则该二维模型的显式差分格式为
\begin{equation*}
	\lb\begin{array}{r@{~}lr@{~}l}
		\frac{U_{jk}^{m + 1} - U_{jk}^m}{\tau} =& a \(\dfrac{U_{j + 1, k}^{m} - 2U_{jk}^{m} + U_{j - 1, k}^{m}}{h_x^2}\rd &&\\
		&\ld + \dfrac{U_{j, k + 1}^{m} - 2U_{jk}^{m} + U_{j, k - 1}^{m}}{h_y^2}\),&	1&\leq j \leq N_x - 1, 1 \leq k \leq N_y - 1, m\geq 0,\\
		U_{jk}^0 =& u_{jk}^0,&	0 &\leq j \leq N_x, 0 \leq k \leq N_y,\\
		U_{0k}^m =& U_{N_x k}^m = U_{j0}^m = U_{jN_y}^m,&	m&\geq 1.
	\end{array}\rd
\end{equation*}

设 $u$ 充分光滑, 由其在 $(x_j, y_k, t_m)$ 处 Taylor 展开知:
\begin{equation*}
	\lb\begin{array}{r@{~}l}
		\dfrac{u_{jk}^{m + 1} - u_{jk}^{m}}{\tau} &= (u_t)_{jk}^m + \dfrac{1}{2} (u_{tt})_{jk}^m\tau + \cdots,\\
		\dfrac{u_{j + 1, k}^{m} - 2u_{jk}^{m} + u_{j - 1, k}^{m}}{h_x} &= (u_{xx})_{jk}^m + \frac{1}{12} (u_{xxxx})_{jk}^m h_x^2 + \frac{1}{360} \(\frac{\pa^6 u}{\pa x^6}\)_{jk}^m h_x^4 + \cdots,
	\end{array}\rd
\end{equation*}
故局部截断误差为
$$Tu(x, y ,t) = \frac{1}{2}u_{tt} \tau - \frac{1}{12} au_{xxxx}h_x^2 - \frac{1}{12} au_{yyyy}h_y^2 + O(\tau^2 + h_x^4 + h_x^4),$$
即 $Tu(x, y ,t) = O(\tau + h_x^2 + h_x^2)$.

令 $\mu_x = \dfrac{a\tau}{h_x^2}$, $\mu_y = \dfrac{a\tau}{h_y^2}$, 则差分格式可以等价地写为
\begin{equation*}
	\lb\begin{array}{r@{~}l}
		U_{jk}^{m + 1} &= (1 - \mu_x - 2\mu_y)U_{jk}^{m} + \mu_x(U_{j + 1, k}^m + U_{j - 1, k}^m + \mu_y(U_{j, k + 1}^m + U_{j, k - 1}^m),\tag{$*$}\\
		e_{jk}^{m + 1} &= (1 - \mu_x - 2\mu_y)e_{jk}^{m} + \mu_x(e_{j + 1, k}^m + e_{j - 1, k}^m + \mu_y(e_{j, k + 1}^m + e_{j, k - 1}^m) - \tau T_{jk}^m,
	\end{array}\rd
\end{equation*}
易知, $(1 - \mu_x - 2\mu_y) \geq 0$, 即 $\mu_x + \mu_y \leq \dfrac{1}{2}$ 时格式满足最大值原理. 于是, 与一位情形类似地, 可知  $\mu_x + \mu_y \leq \dfrac{1}{2}$ 时格式满足最大值原理.

又将 Fourier 波形 $U_{jk}^m = \lambda_\a^m \e^{\i(\a_x x_j + \a_y y_k)}$ 代入 $*$ 式. 其中 $\a_x = \dfrac{l\pi}{X}$, $\a_y = \dfrac{l\pi}{Y}$, $\a = (\a_x, \a_y)$, $l = 1, \cdots, N_x$. 则
\begin{align*}
	\lambda_\a^{m + 1} \e^{\i(\a_x jh_x + \a_y kh_y)} =~& (1 - \mu_x - 2\mu_y) \lambda_\a^{m} \e^{\i(\a_x jh_x + \a_y kh_y)}\\
	&+ \mu_x \(\lambda_\a^{m} \e^{\i(\a_x (j + 1)h_x + \a_y kh_y)} + \lambda_\a^{m} \e^{\i(\a_x (j - 1)h_x + \a_y kh_y)}\)\\
	&+ \mu_y \(\lambda_\a^{m} \e^{\i(\a_x jh_x + \a_y (k + 1)h_y)} + \lambda_\a^{m} \e^{\i(\a_x jh_x + \a_y (k - 1)h_y)}\)
\end{align*}
得增长因子
$$\lambda_\a = 1 - 4\(\mu_x\sin^2\frac{\a_xh_x}{2} + \mu_y\sin^2\frac{\a_yh_y}{2}\),$$
故 $\mu_x + \mu_y \leq \dfrac{1}{2}$ 时, $|\lambda_\a| \leq 1$, 于是与一维情形类似地,  $\mu_x + \mu_y \leq \dfrac{1}{2}$ 时格式 $\mathbb{L}^2$ 稳定且收敛.

Crank-Nicolson

\end{comment}

\subsection{模型问题的 Crank-Nicolson 格式}

在点 $\(x, y, t + \frac{1}{2}\D t\)$ 用 $\frac{\de_t}{\D t}$, 替换 $\frac{\pa}{\pa t}$, 用 $(x, y, t + \D t)$, $(x, y, t)$ 两点的关于空间的二阶中心差商 $\frac{\de_x^2}{(\D x)^2} + \frac{\de_y^2}{(\D y)^2}$ 的平均值替换 $\frac{\pa^2}{\pa x^2}$, 得到问题 \eqref{equ:2d_DirichletProblem} 的 Crank-Nicolson 格式:
\begin{equation*}
	\lb\begin{array}{r@{~}l@{~}r@{~}l}
		\frac{U_{jk}^{m + 1} - U_{jk}^m}{\tau} &= \frac{a}{2} \(\frac{U_{j + 1, k}^{m} - 2U_{jk}^{m} + U_{j - 1, k}^{m}}{h_x^2} + \frac{U_{j, k + 1}^{m} - 2U_{jk}^{m} + U_{j, k - 1}^{m}}{h_y^2}\rd &	1&\leq j \leq N_x - 1, \\
		&\quad\ld + \frac{U_{j + 1, k}^{m + 1}  - 2U_{jk}^{m + 1}  + U_{j - 1, k}^{m + 1} }{h_x^2} + \frac{U_{j, k + 1}^{m + 1} - 2U_{jk}^{m + 1}  + U_{j, k - 1}^{m + 1} }{h_y^2}\),& 1 &\leq k \leq N_y - 1, m\geq 0,\\
		U_{jk}^0 &= u_{jk}^0,&	0 &\leq j \leq N_x, 0 \leq k \leq N_y,\\
		U_{0k}^m &= U_{N_x k}^m = U_{j0}^m = U_{jN_y}^m = 0,&	m&\geq 1.
	\end{array}\rd
\end{equation*}

\subsection{Crank-Nicolson 格式的截断误差}

引入截断误差算子
$$T_{h, \tau} := \(\dfrac{\de_t}{\tau} - a\dfrac{\de_x^2}{h_x^2} - a\dfrac{\de_y^2}{h_y^2}\) - \(\dfrac{\pa}{\pa t} - a\dfrac{\pa^2}{\pa x^2} - a\dfrac{\pa^2}{\pa y^2}\).$$
设 $u$ 充分光滑, 由其在 $(x_j, y_k, t_{m + \frac{1}{2}})$ 处 Taylor 展开知:
$$T_{jk}^{m + \frac{1}{2}} = -\frac{1}{12}(u_{ttt})_{jk}^{m + \frac{1}{2}} - \frac{1}{12}a (u_{xxxx})_{jk}^{m + \frac{1}{2}} h_x^2 - \frac{1}{12}a (u_{yyyy})_{jk}^{m + \frac{1}{2}} h_y^2 + O(\tau^4 + h_x^{4} + h_y^4),$$
故 $Tu(x, y, t) = O(\tau^2 + h_x^2 + h_y^2)$.

\subsection{Crank-Nicolson 格式的稳定性, 收敛性分析}

令 $\mu_x = \dfrac{a\tau}{h_x^2}$, $\mu_y = \dfrac{a\tau}{h_y^2}$, 则差分格式可等价地写为:
\begin{equation}\label{equ:2d_Dirichlet_CN_Scheme}
	\begin{aligned}
		(1 + \mu_x + 2\mu_y) U_{jk}^{m + 1} &= (1 - \mu_x - 2\mu_y)U_{jk}^{m} \\
		&\quad + \frac{1}{2}\mu_x(U_{j + 1, k}^m + U_{j - 1, k}^m + U_{j + 1, k}^{m + 1} + U_{j - 1, k}^{m + 1}),\\
		&\quad + \frac{1}{2}\mu_y(U_{j, k + 1}^m + U_{j, k - 1}^m + U_{j, k + 1}^{m + 1} + U_{j, k - 1}^{m + 1}),
	\end{aligned}
\end{equation}
故 $1 - \mu_x - \mu_y \geq 0$ 时,  即 $\mu_x + \mu_y \leq 1$ 时满足最大值原理， 于是 Crank-Nicolson 格式在 $\mu_x + \mu_y \leq 1$ 时 $\mathbb{L}^\infty$ 稳定且收敛.

将 Fourier 波形 $U_{jk}^m = \lambda_\a^m \e^{\i(\a_x x_j + \a_y y_k)}$ 代入差分格式 \eqref{equ:2d_Dirichlet_CN_Scheme}, 其中
$$\a_x = \dfrac{l\pi}{X},\quad \a_y = \dfrac{l\pi}{Y},\quad \a = (\a_x, \a_y),\quad l = 1, \cdots, N_x,$$
可得增长因子
$$\lambda_\a = \frac{1 - 2\(\mu_x\sin^2\frac{\a_xh_x}{2} + \mu_y\sin^2\frac{\a_yh_y}{2}\)}{1 + 2\(\mu_x\sin^2\frac{\a_xh_x}{2} + \mu_y\sin^2\frac{\a_yh_y}{2}\)},$$
即 $|\lambda_\a| \leq 1$ 对任意 $\a$ 成立, 即 Crank-Nicolson 格式无条件 $\mathbb{L}^2$ 稳定且收敛.

\begin{appendices}

	\href{https://github.com/Quejiahao/NumericalSolutionOfPartialDifferentialEquations.jl}{数值实验源码}

\end{appendices}

\end{document}
